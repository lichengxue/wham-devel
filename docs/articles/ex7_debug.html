<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ex 7: Debugging WHAM models • wham</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Ex 7: Debugging WHAM models">
<meta property="og:description" content="wham">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wham</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book fa-lg"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html">Overview</a>
    </li>
    <li>
      <a href="../articles/ex1_basics.html">Ex 1: The basics</a>
    </li>
    <li>
      <a href="../articles/ex2_CPI_recruitment.html">Ex 2: Recruitment linked to an environmental covariate (Cold Pool Index)</a>
    </li>
    <li>
      <a href="../articles/ex3_projections.html">Ex 3: Projecting / forecasting random effects</a>
    </li>
    <li>
      <a href="../articles/ex4_selectivity.html">Ex 4: Selectivity with time- and age-varying random effects</a>
    </li>
    <li>
      <a href="../articles/ex5_GSI_M.html">Ex 5: Time-varying natural mortality linked to the Gulf Stream Index</a>
    </li>
    <li>
      <a href="../articles/ex6_NAA.html">Ex 6: Numbers-at-age / survival deviations as random effects</a>
    </li>
    <li>
      <a href="../articles/ex7_debug.html">Ex 7: Debugging WHAM models</a>
    </li>
    <li>
      <a href="../articles/ex8_compare.html">Ex 8: Compare ASAP and WHAM model results</a>
    </li>
    <li>
      <a href="../articles/ex9_retro_pred.html">Ex 9: Retrospective predictions</a>
    </li>
    <li>
      <a href="../articles/ex10_simulation.html">Ex 10: Simulation and MSE</a>
    </li>
    <li>
      <a href="../articles/ex11_catchability.html">Ex 11: Catchability configurations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code fa-lg"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="https://github.com/timjmiller/wham/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
    Source code
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-bullhorn fa-lg"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/timjmiller/wham/issues/" class="external-link">
    <span class="fas fa-question-circle fa-lg"></span>
     
    Issues
  </a>
</li>
<li>
  <a href="https://www.fisheries.noaa.gov/contact/timothy-miller-phd" class="external-link">
    <span class="fas fa-paper-plane fa-lg"></span>
     
    Contact
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Ex 7: Debugging WHAM models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/timjmiller/wham/blob/HEAD/vignettes/ex7_debug.Rmd" class="external-link"><code>vignettes/ex7_debug.Rmd</code></a></small>
      <div class="hidden name"><code>ex7_debug.Rmd</code></div>

    </div>

    
    
<p>In this vignette we show how to use the <code>do.fit = FALSE</code>
flag to debug a WHAM model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github("timjmiller/wham", dependencies=TRUE)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://timjmiller.github.io/wham/">wham</a></span><span class="op">)</span></span></code></pre></div>
<p>Load the ASAP3 data file.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wham.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"wham"</span><span class="op">)</span></span>
<span><span class="va">asap3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_asap3_dat.html">read_asap3_dat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wham.dir</span>,<span class="st">"extdata"</span>,<span class="st">"ex7_SNEMAYT.dat"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Prepare the WHAM model (<code>m3</code> from <a href="https://timjmiller.github.io/wham/articles/ex1_SNEMA_yellowtail_flounder.html">example
1</a>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span><span class="va">asap3</span>, recruit_model<span class="op">=</span><span class="fl">2</span>, model_name<span class="op">=</span><span class="st">"Ex 1: SNEMA Yellowtail Flounder"</span>,</span>
<span>                              NAA_re <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sigma<span class="op">=</span><span class="st">"rec+1"</span>, cor<span class="op">=</span><span class="st">"iid"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Try to fit the model… uh oh.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input</span>, do.osa <span class="op">=</span> <span class="cn">F</span>, do.retro <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; Order of parameters:</span></span>
<span><span class="co">#&gt;  [1] "log_catch_sig_scale"  "log_index_sig_scale"  "log_N1_pars"         </span></span>
<span><span class="co">#&gt;  [4] "log_NAA_sigma"        "trans_NAA_rho"        "log_NAA"             </span></span>
<span><span class="co">#&gt;  [7] "logR_proj"            "mean_rec_pars"        "logit_q"             </span></span>
<span><span class="co">#&gt; [10] "q_re"                 "q_repars"             "q_prior_re"          </span></span>
<span><span class="co">#&gt; [13] "logit_selpars"        "selpars_re"           "sel_repars"          </span></span>
<span><span class="co">#&gt; [16] "catch_paa_pars"       "index_paa_pars"       "F_devs"              </span></span>
<span><span class="co">#&gt; [19] "log_F1"               "M_a"                  "M_re"                </span></span>
<span><span class="co">#&gt; [22] "M_repars"             "log_b"                "Ecov_re"             </span></span>
<span><span class="co">#&gt; [25] "Ecov_beta"            "Ecov_process_pars"    "Ecov_obs_logsigma"   </span></span>
<span><span class="co">#&gt; [28] "Ecov_obs_sigma_par"   "Ecov_obs_logsigma_re"</span></span>
<span><span class="co">#&gt; Not matching template order:</span></span>
<span><span class="co">#&gt;  [1] "mean_rec_pars"        "logit_q"              "q_prior_re"          </span></span>
<span><span class="co">#&gt;  [4] "q_re"                 "q_repars"             "log_F1"              </span></span>
<span><span class="co">#&gt;  [7] "F_devs"               "log_N1_pars"          "log_NAA_sigma"       </span></span>
<span><span class="co">#&gt; [10] "trans_NAA_rho"        "log_NAA"              "logR_proj"           </span></span>
<span><span class="co">#&gt; [13] "logit_selpars"        "selpars_re"           "sel_repars"          </span></span>
<span><span class="co">#&gt; [16] "catch_paa_pars"       "index_paa_pars"       "M_a"                 </span></span>
<span><span class="co">#&gt; [19] "M_re"                 "M_repars"             "log_b"               </span></span>
<span><span class="co">#&gt; [22] "log_catch_sig_scale"  "log_index_sig_scale"  "Ecov_re"             </span></span>
<span><span class="co">#&gt; [25] "Ecov_beta"            "Ecov_process_pars"    "Ecov_obs_logsigma"   </span></span>
<span><span class="co">#&gt; [28] "Ecov_obs_logsigma_re" "Ecov_obs_sigma_par"  </span></span>
<span><span class="co">#&gt; Your parameter list has been re-ordered.</span></span>
<span><span class="co">#&gt; (Disable this warning with checkParameterOrder=FALSE)</span></span>
<span><span class="co">#&gt; iter: 1  Error in iterate(par) : </span></span>
<span><span class="co">#&gt;   Newton dropout because inner gradient had non-finite components.</span></span>
<span><span class="co">#&gt; Warning in stats::nlminb(model$par, model$fn, model$gr, control = list(iter.max</span></span>
<span><span class="co">#&gt; = 1000, : NA/NaN function evaluation</span></span>
<span><span class="co">#&gt; iter: 1  Error in iterate(par) : </span></span>
<span><span class="co">#&gt;   Newton dropout because inner gradient had non-finite components.</span></span>
<span><span class="co">#&gt; Error in ff(x, order = 1) : </span></span>
<span><span class="co">#&gt;   inner newton optimization failed during gradient calculation</span></span>
<span><span class="co">#&gt; outer mgc:  NaN</span></span>
<span><span class="co">#&gt; Error in stats::nlminb(model$par, model$fn, model$gr, control = list(iter.max = 1000, : NA/NaN gradient evaluation</span></span></code></pre></div>
<p>What’s wrong? It looks like the likelihood function is returning
<code>NaN</code>. It is often easier to diagnose problems like this
using the <em>unoptimized</em> model, i.e. look at everything using the
initial parameter values. WHAM includes a <code>do.fit = F</code> flag
in <code>fit_wham</code> to return the unoptimized model object returned
by <code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">TMB::MakeADFun</a></code>. Let’s see how it works.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input</span>, do.fit <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; Order of parameters:</span></span>
<span><span class="co">#&gt;  [1] "log_catch_sig_scale"  "log_index_sig_scale"  "log_N1_pars"         </span></span>
<span><span class="co">#&gt;  [4] "log_NAA_sigma"        "trans_NAA_rho"        "log_NAA"             </span></span>
<span><span class="co">#&gt;  [7] "logR_proj"            "mean_rec_pars"        "logit_q"             </span></span>
<span><span class="co">#&gt; [10] "q_re"                 "q_repars"             "q_prior_re"          </span></span>
<span><span class="co">#&gt; [13] "logit_selpars"        "selpars_re"           "sel_repars"          </span></span>
<span><span class="co">#&gt; [16] "catch_paa_pars"       "index_paa_pars"       "F_devs"              </span></span>
<span><span class="co">#&gt; [19] "log_F1"               "M_a"                  "M_re"                </span></span>
<span><span class="co">#&gt; [22] "M_repars"             "log_b"                "Ecov_re"             </span></span>
<span><span class="co">#&gt; [25] "Ecov_beta"            "Ecov_process_pars"    "Ecov_obs_logsigma"   </span></span>
<span><span class="co">#&gt; [28] "Ecov_obs_sigma_par"   "Ecov_obs_logsigma_re"</span></span>
<span><span class="co">#&gt; Not matching template order:</span></span>
<span><span class="co">#&gt;  [1] "mean_rec_pars"        "logit_q"              "q_prior_re"          </span></span>
<span><span class="co">#&gt;  [4] "q_re"                 "q_repars"             "log_F1"              </span></span>
<span><span class="co">#&gt;  [7] "F_devs"               "log_N1_pars"          "log_NAA_sigma"       </span></span>
<span><span class="co">#&gt; [10] "trans_NAA_rho"        "log_NAA"              "logR_proj"           </span></span>
<span><span class="co">#&gt; [13] "logit_selpars"        "selpars_re"           "sel_repars"          </span></span>
<span><span class="co">#&gt; [16] "catch_paa_pars"       "index_paa_pars"       "M_a"                 </span></span>
<span><span class="co">#&gt; [19] "M_re"                 "M_repars"             "log_b"               </span></span>
<span><span class="co">#&gt; [22] "log_catch_sig_scale"  "log_index_sig_scale"  "Ecov_re"             </span></span>
<span><span class="co">#&gt; [25] "Ecov_beta"            "Ecov_process_pars"    "Ecov_obs_logsigma"   </span></span>
<span><span class="co">#&gt; [28] "Ecov_obs_logsigma_re" "Ecov_obs_sigma_par"  </span></span>
<span><span class="co">#&gt; Your parameter list has been re-ordered.</span></span>
<span><span class="co">#&gt; (Disable this warning with checkParameterOrder=FALSE)</span></span></code></pre></div>
<p>This runs without an error. The optimization failed because the
likelihood was <code>NaN</code>, and now we can see which of the
likelihood components was responsible. To do so, we need to look at the
<code>REPORT</code>ed objects with <code>"nll"</code> in their name. We
can use the <code>$report()</code> function from TMB.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">therep</span> <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>See all of the <code>REPORT</code>ed objects.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">therep</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "pred_log_catch"        "q_prior_re"            "selAA"                </span></span>
<span><span class="co">#&gt;  [4] "sigma_q"               "FAA_tot"               "log_SPR0"             </span></span>
<span><span class="co">#&gt;  [7] "Ecov_beta"             "log_FXSPR"             "Ecov_obs_sigma_par"   </span></span>
<span><span class="co">#&gt; [10] "NAA_devs"              "mean_rec_pars"         "QAA"                  </span></span>
<span><span class="co">#&gt; [13] "nll_catch_acomp"       "M_a"                   "pred_catch_paa"       </span></span>
<span><span class="co">#&gt; [16] "MAA"                   "log_Y_FXSPR_static"    "SSB"                  </span></span>
<span><span class="co">#&gt; [19] "F"                     "nll_agg_indices"       "nll"                  </span></span>
<span><span class="co">#&gt; [22] "log_YPR_FXSPR"         "log_R_FXSPR_static"    "nll_Ecov_obs"         </span></span>
<span><span class="co">#&gt; [25] "selpars"               "nll_Ecov_obs_sig"      "Ecov_re"              </span></span>
<span><span class="co">#&gt; [28] "log_SPR_FXSPR"         "log_SPR0_static"       "pred_indices"         </span></span>
<span><span class="co">#&gt; [31] "nll_NAA"               "log_FXSPR_static"      "pred_IAA"             </span></span>
<span><span class="co">#&gt; [34] "logit_q_mat"           "pred_CAA"              "nll_agg_catch"        </span></span>
<span><span class="co">#&gt; [37] "nll_sel"               "log_FXSPR_iter"        "nll_q"                </span></span>
<span><span class="co">#&gt; [40] "logit_selpars"         "Fbar"                  "nll_Ecov"             </span></span>
<span><span class="co">#&gt; [43] "log_FXSPR_iter_static" "Ecov_obs_sigma"        "rho_q"                </span></span>
<span><span class="co">#&gt; [46] "q_re"                  "Ecov_process_pars"     "sel_repars"           </span></span>
<span><span class="co">#&gt; [49] "nll_index_acomp"       "ZAA"                   "pred_log_indices"     </span></span>
<span><span class="co">#&gt; [52] "M_re"                  "selpars_re"            "Ecov_x"               </span></span>
<span><span class="co">#&gt; [55] "NAA"                   "pred_catch"            "R_XSPR"               </span></span>
<span><span class="co">#&gt; [58] "log_SSB_FXSPR"         "M_repars"              "log_SSB_FXSPR_static" </span></span>
<span><span class="co">#&gt; [61] "pred_NAA"              "FAA"                   "log_SPR_FXSPR_static" </span></span>
<span><span class="co">#&gt; [64] "nll_q_prior"           "log_Y_FXSPR"           "pred_index_paa"       </span></span>
<span><span class="co">#&gt; [67] "Ecov_out"              "nll_M"                 "log_YPR_FXSPR_static" </span></span>
<span><span class="co">#&gt; [70] "q"</span></span></code></pre></div>
<p>Now just get the objects with <code>"nll"</code> in their name, and
sum over all individual values.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"nll"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">therep</span><span class="op">)</span>,value<span class="op">=</span><span class="cn">T</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">therep</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  nll_catch_acomp  nll_agg_indices              nll     nll_Ecov_obs </span></span>
<span><span class="co">#&gt;        2844.2380        1562.8441              NaN           0.0000 </span></span>
<span><span class="co">#&gt; nll_Ecov_obs_sig          nll_NAA    nll_agg_catch          nll_sel </span></span>
<span><span class="co">#&gt;           0.0000         346.2991              NaN           0.0000 </span></span>
<span><span class="co">#&gt;            nll_q         nll_Ecov  nll_index_acomp      nll_q_prior </span></span>
<span><span class="co">#&gt;           0.0000           0.0000        3921.8316           0.0000 </span></span>
<span><span class="co">#&gt;            nll_M </span></span>
<span><span class="co">#&gt;           0.0000</span></span></code></pre></div>
<p>The likelihood components that are equal to 0 are not used in the
model (no random effects on <code>M</code>, <code>Ecov</code>,
<code>selectivity</code>, etc.). <code>nll</code> is the total
likelihood and is <code>NaN</code>. The one troublesome component is
<code>nll_agg_catch</code>. This is the total (aggregate) catch from the
fishery in each year. It could be an issue with the catch data or the
model-predicted catch, since both are in the likelihood calculation.</p>
<p>Search the <a href="https://github.com/timjmiller/wham/blob/master/src/wham_v0.cpp" class="external-link">WHAM
.cpp file</a> for “nll_agg_catch”. We find that on line 888, this
depends on <code>agg_catch</code> (the catch data) and
<code>pred_catch</code> (model-predicted catch).</p>
<p>The catch data looks ok.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_catch</span></span>
<span><span class="co">#&gt;             [,1]</span></span>
<span><span class="co">#&gt;  [1,] 14549.0000</span></span>
<span><span class="co">#&gt;  [2,] 17088.0000</span></span>
<span><span class="co">#&gt;  [3,]  5732.0000</span></span>
<span><span class="co">#&gt;  [4,]  3436.0000</span></span>
<span><span class="co">#&gt;  [5,]  5223.0000</span></span>
<span><span class="co">#&gt;  [6,]  8085.0000</span></span>
<span><span class="co">#&gt;  [7,]  9883.0000</span></span>
<span><span class="co">#&gt;  [8,]  8021.0000</span></span>
<span><span class="co">#&gt;  [9,]  6607.0000</span></span>
<span><span class="co">#&gt; [10,] 15764.0000</span></span>
<span><span class="co">#&gt; [11,] 22211.0000</span></span>
<span><span class="co">#&gt; [12,] 11225.0000</span></span>
<span><span class="co">#&gt; [13,]  4817.0000</span></span>
<span><span class="co">#&gt; [14,]  4620.0000</span></span>
<span><span class="co">#&gt; [15,]  2652.0000</span></span>
<span><span class="co">#&gt; [16,]  2782.0000</span></span>
<span><span class="co">#&gt; [17,]  8349.0000</span></span>
<span><span class="co">#&gt; [18,] 17916.0000</span></span>
<span><span class="co">#&gt; [19,]  6430.0000</span></span>
<span><span class="co">#&gt; [20,]  2695.0000</span></span>
<span><span class="co">#&gt; [21,]   771.0008</span></span>
<span><span class="co">#&gt; [22,]   735.0004</span></span>
<span><span class="co">#&gt; [23,]   343.0004</span></span>
<span><span class="co">#&gt; [24,]   759.0001</span></span>
<span><span class="co">#&gt; [25,]  1222.0000</span></span>
<span><span class="co">#&gt; [26,]  1087.0000</span></span>
<span><span class="co">#&gt; [27,]  1403.0000</span></span>
<span><span class="co">#&gt; [28,]  1397.0000</span></span>
<span><span class="co">#&gt; [29,]  1449.0000</span></span>
<span><span class="co">#&gt; [30,]   945.0005</span></span>
<span><span class="co">#&gt; [31,]   666.0005</span></span>
<span><span class="co">#&gt; [32,]   619.0002</span></span>
<span><span class="co">#&gt; [33,]   346.0002</span></span>
<span><span class="co">#&gt; [34,]   396.0000</span></span>
<span><span class="co">#&gt; [35,]   502.0004</span></span>
<span><span class="co">#&gt; [36,]   583.0006</span></span>
<span><span class="co">#&gt; [37,]   453.0006</span></span>
<span><span class="co">#&gt; [38,]   290.9995</span></span>
<span><span class="co">#&gt; [39,]   390.0002</span></span>
<span><span class="co">#&gt; [40,]   563.0002</span></span>
<span><span class="co">#&gt; [41,]   645.9999</span></span>
<span><span class="co">#&gt; [42,]   625.0000</span></span>
<span><span class="co">#&gt; [43,]   337.0005</span></span>
<span><span class="co">#&gt; [44,]   151.9999</span></span></code></pre></div>
<p>The predicted catch is calculated on lines 879-880.
<code>pred_catch</code> depends on <code>NAA</code> (numbers-at-age),
<code>FAA</code> (F at age), <code>ZAA</code> (Z at age), and
<code>waa</code> (weight-at-age data).</p>
<p><code>NAA</code> looks ok.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">therep</span><span class="op">$</span><span class="va">NAA</span></span>
<span><span class="co">#&gt;            [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span></span>
<span><span class="co">#&gt;  [1,] 134809.00 11710.97 25945.08 17508.26 11476.00 13803.70</span></span>
<span><span class="co">#&gt;  [2,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt;  [3,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt;  [4,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt;  [5,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt;  [6,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt;  [7,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt;  [8,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt;  [9,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [10,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [11,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [12,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [13,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [14,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [15,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [16,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [17,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [18,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [19,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [20,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [21,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [22,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [23,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [24,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [25,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [26,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [27,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [28,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [29,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [30,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [31,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [32,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [33,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [34,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [35,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [36,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [37,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [38,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [39,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [40,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [41,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [42,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [43,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span>
<span><span class="co">#&gt; [44,]  22026.47 22026.47 22026.47 22026.47 22026.47 22026.47</span></span></code></pre></div>
<p><code>FAA</code> looks ok - no issues with <code>F</code> or
selectivity.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">therep</span><span class="op">$</span><span class="va">FAA</span><span class="op">[</span>,<span class="fl">1</span>,<span class="op">]</span> <span class="co"># middle dim is n.fleets = 1</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]       [,5] [,6]</span></span>
<span><span class="co">#&gt;  [1,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt;  [2,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt;  [3,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt;  [4,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt;  [5,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt;  [6,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt;  [7,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt;  [8,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt;  [9,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [10,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [11,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [12,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [13,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [14,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [15,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [16,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [17,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [18,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [19,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [20,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [21,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [22,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [23,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [24,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [25,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [26,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [27,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [28,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [29,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [30,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [31,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [32,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [33,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [34,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [35,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [36,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [37,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [38,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [39,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [40,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [41,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [42,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [43,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span>
<span><span class="co">#&gt; [44,] 0.0501933 0.07552447 0.09057153 0.09692876 0.09922137  0.1</span></span></code></pre></div>
<p><code>ZAA</code> looks ok - no issues with <code>M</code> either.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">therep</span><span class="op">$</span><span class="va">ZAA</span></span>
<span><span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]     [,6]</span></span>
<span><span class="co">#&gt;  [1,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt;  [2,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt;  [3,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt;  [4,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt;  [5,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt;  [6,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt;  [7,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt;  [8,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt;  [9,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [10,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [11,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [12,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [13,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [14,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [15,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [16,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [17,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [18,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [19,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [20,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [21,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [22,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [23,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [24,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [25,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [26,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [27,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [28,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [29,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [30,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [31,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [32,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [33,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [34,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [35,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [36,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [37,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [38,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [39,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [40,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [41,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [42,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [43,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span>
<span><span class="co">#&gt; [44,] 0.4551933 0.4115245 0.3865715 0.3719288 0.3552214 0.331099</span></span></code></pre></div>
<p>Ah, here is the problem. The weight at age data has an entry of
<code>-99</code>. This means that <code>pred_catch</code> is negative on
line 880, and we take the log of a negative number on line 883.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">waa</span><span class="op">[</span><span class="fl">1</span>,,<span class="op">]</span></span>
<span><span class="co">#&gt;          [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></span>
<span><span class="co">#&gt;  [1,]   0.210 0.296 0.348 0.374 0.382 0.428</span></span>
<span><span class="co">#&gt;  [2,]   0.203 0.308 0.352 0.396 0.439 0.457</span></span>
<span><span class="co">#&gt;  [3,]   0.218 0.289 0.376 0.432 0.435 0.481</span></span>
<span><span class="co">#&gt;  [4,]   0.228 0.303 0.408 0.498 0.499 0.557</span></span>
<span><span class="co">#&gt;  [5,]   0.215 0.283 0.381 0.504 0.513 0.542</span></span>
<span><span class="co">#&gt;  [6,]   0.234 0.292 0.383 0.536 0.662 0.656</span></span>
<span><span class="co">#&gt;  [7,]   0.189 0.301 0.364 0.475 0.590 0.662</span></span>
<span><span class="co">#&gt;  [8,]   0.206 0.281 0.384 0.500 0.682 0.925</span></span>
<span><span class="co">#&gt;  [9,]   0.140 0.262 0.342 0.474 0.596 0.650</span></span>
<span><span class="co">#&gt; [10,]   0.226 0.263 0.353 0.499 0.660 0.833</span></span>
<span><span class="co">#&gt; [11,]   0.175 0.261 0.339 0.496 0.668 0.819</span></span>
<span><span class="co">#&gt; [12,]   0.182 0.237 0.295 0.388 0.487 0.656</span></span>
<span><span class="co">#&gt; [13,]   0.183 0.260 0.365 0.408 0.504 0.608</span></span>
<span><span class="co">#&gt; [14,]   0.186 0.284 0.331 0.463 0.587 0.642</span></span>
<span><span class="co">#&gt; [15,]   0.247 0.268 0.353 0.404 0.520 0.631</span></span>
<span><span class="co">#&gt; [16,]   0.270 0.293 0.396 0.493 0.611 0.821</span></span>
<span><span class="co">#&gt; [17,]   0.061 0.216 0.275 0.489 0.735 0.957</span></span>
<span><span class="co">#&gt; [18,]   0.204 0.255 0.290 0.366 0.613 0.884</span></span>
<span><span class="co">#&gt; [19,]   0.090 0.214 0.294 0.378 0.664 0.798</span></span>
<span><span class="co">#&gt; [20,]   0.110 0.303 0.375 0.447 0.631 0.918</span></span>
<span><span class="co">#&gt; [21,]   0.122 0.314 0.420 0.439 0.640 1.040</span></span>
<span><span class="co">#&gt; [22,]   0.078 0.247 0.321 0.387 0.480 0.622</span></span>
<span><span class="co">#&gt; [23,]   0.076 0.216 0.325 0.401 0.579 0.758</span></span>
<span><span class="co">#&gt; [24,]   0.102 0.335 0.368 0.457 0.604 0.740</span></span>
<span><span class="co">#&gt; [25,]   0.139 0.251 0.396 0.466 0.584 0.768</span></span>
<span><span class="co">#&gt; [26,]   0.160 0.287 0.367 0.494 0.567 0.726</span></span>
<span><span class="co">#&gt; [27,]   0.131 0.309 0.400 0.557 0.629 1.695</span></span>
<span><span class="co">#&gt; [28,]   0.185 0.321 0.444 0.561 0.667 0.752</span></span>
<span><span class="co">#&gt; [29,]   0.145 0.360 0.419 0.567 0.684 0.824</span></span>
<span><span class="co">#&gt; [30,]   0.164 0.330 0.438 0.574 0.764 0.751</span></span>
<span><span class="co">#&gt; [31,]   0.095 0.313 0.413 0.572 0.722 0.945</span></span>
<span><span class="co">#&gt; [32,]   0.136 0.295 0.436 0.540 0.581 0.799</span></span>
<span><span class="co">#&gt; [33,]   0.102 0.295 0.415 0.511 0.634 0.795</span></span>
<span><span class="co">#&gt; [34,]   0.110 0.251 0.373 0.475 0.607 0.783</span></span>
<span><span class="co">#&gt; [35,]   0.111 0.268 0.363 0.472 0.628 0.834</span></span>
<span><span class="co">#&gt; [36,]   0.151 0.266 0.388 0.461 0.574 1.077</span></span>
<span><span class="co">#&gt; [37,]   0.105 0.281 0.367 0.502 0.601 0.753</span></span>
<span><span class="co">#&gt; [38,]   0.099 0.281 0.414 0.470 0.573 0.702</span></span>
<span><span class="co">#&gt; [39,]   0.130 0.280 0.412 0.491 0.572 0.717</span></span>
<span><span class="co">#&gt; [40,]   0.120 0.251 0.365 0.475 0.554 0.709</span></span>
<span><span class="co">#&gt; [41,]   0.154 0.254 0.351 0.453 0.565 0.683</span></span>
<span><span class="co">#&gt; [42,] -99.000 0.345 0.396 0.459 0.565 0.689</span></span>
<span><span class="co">#&gt; [43,]   0.046 0.281 0.388 0.476 0.548 0.685</span></span>
<span><span class="co">#&gt; [44,]   0.000 0.270 0.349 0.434 0.521 0.629</span></span></code></pre></div>
<p>If we fix this issue with the data file, the model runs fine!</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tim Miller, Brian Stock.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
